<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GetFileAsync Bug</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
    <script>
        function startMeUp(){
            Office.initialize = function () {
            console.log('starting up');
            document.getElementById("output").innerHTML = "Started"
            }
        }

      function getDocumentAsCompressed(){
          console.log("at getDocumentAsCompressed")
          document.getElementById("output").innerHTML = "Clicked"
      }

    </script>
  </head>
  <body onload="startMeUp();">
    <p>Click the button once to see how many bytes are the in current workbook.  Click it again to crash Excel.</p>
    <button onclick="getDocumentAsCompressed()">File Bytes</button>
    <p id="output"></p>
  </body>
</html>
